@model Thermory.Web.Models.InventoryWorksheet
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var firstCategoryId = Model.LumberProductCategories.First().Id;
}

<ul class="nav nav-tabs" data-tabs="tabs">
    @{
        foreach (var category in Model.LumberProductCategories)
        {
            var active = category.Id == firstCategoryId ? "class=active" : "";
            <li @active><a href="#@category.Id" data-toggle="tab">@category.Name</a></li>
        }
    }
</ul>
<div class="tab-content" style="height: 500px; overflow: auto;">
    @{
        foreach (var category in Model.LumberProductCategories)
        {
            var active = category.Id == firstCategoryId ? "active" : "";
            <div id="@category.Id" class="tab-pane @active">
                @Html.Partial("_LumberAuditForm", category)
            </div>
        }
    }
</div>
<button type="button" class="btn btn-default" onclick="saveInventory();">Save</button>
<script type="text/javascript">
    function saveInventory() {
        var inventory = new Array();
        $("input[name^='inventory']").each(function() {
            inventory.push({
                Product: { Id: $(this).attr('id') },
                Quantity: $(this).val()
            });
        });

        var postData = JSON.stringify(inventory);

        $.ajax({
            type: 'POST',
            url: '@Url.Action("Index", "InventoryAudit")',
            contentType: 'application/json',
            dataType: 'json',
            data: postData,
            success: function(data, status, request) {
                location.reload();
            }
        });
    }
</script>